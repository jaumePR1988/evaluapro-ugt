(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[427],{2898:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});var n=t(2265),a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),r=(e,s)=>{let t=(0,n.forwardRef)(({color:t="currentColor",size:r=24,strokeWidth:l=2,absoluteStrokeWidth:c,className:d="",children:o,...u},x)=>(0,n.createElement)("svg",{ref:x,...a,width:r,height:r,stroke:t,strokeWidth:c?24*Number(l)/Number(r):l,className:["lucide",`lucide-${i(e)}`,d].join(" "),...u},[...s.map(([e,s])=>(0,n.createElement)(e,s)),...Array.isArray(o)?o:[o]]));return t.displayName=`${e}`,t}},3008:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,t(2898).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},5883:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,t(2898).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},5011:function(e,s,t){Promise.resolve().then(t.bind(t,8208))},8208:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return p}});var n=t(7437),a=t(2265),i=t(1396),r=t.n(i),l=t(4033),c=t(5922),d=t(8810),o=t(5883),u=t(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,u.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),m=(0,u.Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);var h=t(3008);function p(){let{user:e,signOut:s}=(0,d.useAuth)(),t=(0,l.useRouter)(),[i,u]=(0,a.useState)([]),[p,g]=(0,a.useState)("all"),[f,j]=(0,a.useState)(!0);(0,a.useEffect)(()=>{y()},[p]);let y=async()=>{j(!0);let e=c.O.from("requests").select("*").order("created_at",{ascending:!1});"all"!==p&&(e=e.eq("status",p));let{data:s,error:t}=await e;s&&u(s),j(!1)},N=async(e,s)=>{await c.O.from("requests").update({status:s}).eq("id",e),y()},b=e=>(0,n.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-semibold ".concat({pending:"bg-yellow-100 text-yellow-800",in_progress:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"}[e]),children:{pending:"Pendiente",in_progress:"En Progreso",completed:"Completada",cancelled:"Cancelada"}[e]}),v=async()=>{await s(),t.push("/")};return(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,n.jsx)("header",{className:"bg-ugt-red text-white",children:(0,n.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Panel de Administraci\xf3n - Eval\xfaaPro UGT"}),(0,n.jsxs)("p",{className:"text-sm opacity-90 mt-1",children:["Bienvenido/a, ",null==e?void 0:e.email]})]}),(0,n.jsxs)("nav",{className:"flex space-x-4",children:[(0,n.jsx)(r(),{href:"/admin/dashboard",className:"hover:underline font-semibold",children:"Dashboard"}),(0,n.jsx)(r(),{href:"/admin/configuracion",className:"hover:underline",children:"Configuraci\xf3n"}),(0,n.jsxs)("button",{onClick:v,className:"hover:underline flex items-center",children:[(0,n.jsx)(o.Z,{size:16,className:"mr-1"})," Salir"]})]})]})})}),(0,n.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,n.jsxs)("div",{className:"grid md:grid-cols-3 gap-6 mb-8",children:[(0,n.jsx)("div",{className:"card",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Solicitudes Pendientes"}),(0,n.jsx)("p",{className:"text-3xl font-bold text-yellow-600",children:i.filter(e=>"pending"===e.status).length})]}),(0,n.jsx)(x,{className:"text-yellow-600",size:40})]})}),(0,n.jsx)("div",{className:"card",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"En Progreso"}),(0,n.jsx)("p",{className:"text-3xl font-bold text-blue-600",children:i.filter(e=>"in_progress"===e.status).length})]}),(0,n.jsx)(m,{className:"text-blue-600",size:40})]})}),(0,n.jsx)("div",{className:"card",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Completadas"}),(0,n.jsx)("p",{className:"text-3xl font-bold text-green-600",children:i.filter(e=>"completed"===e.status).length})]}),(0,n.jsx)(h.Z,{className:"text-green-600",size:40})]})})]}),(0,n.jsx)("div",{className:"card mb-6",children:(0,n.jsxs)("div",{className:"flex space-x-4",children:[(0,n.jsx)("button",{onClick:()=>g("all"),className:"px-4 py-2 rounded ".concat("all"===p?"bg-ugt-red text-white":"bg-gray-200"),children:"Todas"}),(0,n.jsx)("button",{onClick:()=>g("pending"),className:"px-4 py-2 rounded ".concat("pending"===p?"bg-ugt-red text-white":"bg-gray-200"),children:"Pendientes"}),(0,n.jsx)("button",{onClick:()=>g("in_progress"),className:"px-4 py-2 rounded ".concat("in_progress"===p?"bg-ugt-red text-white":"bg-gray-200"),children:"En Progreso"}),(0,n.jsx)("button",{onClick:()=>g("completed"),className:"px-4 py-2 rounded ".concat("completed"===p?"bg-ugt-red text-white":"bg-gray-200"),children:"Completadas"})]})}),(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Solicitudes"}),f?(0,n.jsx)("p",{children:"Cargando..."}):0===i.length?(0,n.jsx)("p",{className:"text-gray-600",children:"No hay solicitudes"}):(0,n.jsx)("div",{className:"space-y-4",children:i.map(e=>(0,n.jsxs)("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-bold text-lg",children:e.company_name}),(0,n.jsx)("p",{className:"text-gray-600",children:e.position_name})]}),b(e.status)]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-gray-600",children:"Solicitante:"}),(0,n.jsx)("p",{className:"font-semibold",children:e.requester_name})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-gray-600",children:"Email:"}),(0,n.jsx)("p",{className:"font-semibold",children:e.requester_email})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-gray-600",children:"Convenio:"}),(0,n.jsx)("p",{className:"font-semibold",children:e.collective_agreement})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-gray-600",children:"Fecha:"}),(0,n.jsx)("p",{className:"font-semibold",children:new Date(e.created_at).toLocaleDateString("es-ES")})]})]}),(0,n.jsxs)("div",{className:"flex space-x-2",children:["pending"===e.status&&(0,n.jsx)(r(),{href:"/admin/evaluar/".concat(e.id),className:"btn-primary text-sm",children:"Iniciar Valoraci\xf3n"}),"in_progress"===e.status&&(0,n.jsx)(r(),{href:"/admin/evaluar/".concat(e.id),className:"btn-primary text-sm",children:"Continuar Valoraci\xf3n"}),"pending"===e.status&&(0,n.jsx)("button",{onClick:()=>N(e.id,"in_progress"),className:"btn-secondary text-sm",children:"Marcar En Progreso"})]})]},e.id))})]})]})]})}},8810:function(e,s,t){"use strict";t.r(s),t.d(s,{AuthProvider:function(){return l},useAuth:function(){return c}});var n=t(7437),a=t(2265),i=t(5922);let r=(0,a.createContext)(void 0);function l(e){let{children:s}=e,[t,l]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0);(0,a.useEffect)(()=>{!async function(){d(!0);try{let{data:{user:e}}=await i.O.auth.getUser();l(e)}finally{d(!1)}}();let{data:{subscription:e}}=i.O.auth.onAuthStateChange((e,s)=>{l((null==s?void 0:s.user)||null)});return()=>e.unsubscribe()},[]);let o=async(e,s)=>{let{data:t,error:n}=await i.O.auth.signInWithPassword({email:e,password:s});if(n)throw n;return t},u=async(e,s,t)=>{if(!e.endsWith("@ugt.es"))throw Error("Solo se permiten correos del dominio @ugt.es");let{data:n,error:a}=await i.O.auth.signUp({email:e,password:s,options:{data:{full_name:t}}});if(a)throw a;return n.user&&await i.O.from("profiles").insert([{id:n.user.id,email:n.user.email,full_name:t,role:"tecnico",is_active:!0}]),n},x=async()=>{await i.O.auth.signOut()};return(0,n.jsx)(r.Provider,{value:{user:t,loading:c,signIn:o,signUp:u,signOut:x},children:s})}function c(){let e=(0,a.useContext)(r);if(void 0===e)throw Error("useAuth debe usarse dentro de un AuthProvider");return e}},5922:function(e,s,t){"use strict";t.d(s,{O:function(){return n}});let n=(0,t(359).eI)("https://ebiqbjgrmjdkwlckmpuj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImViaXFiamdybWpka3dsY2ttcHVqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIwMjkyMDUsImV4cCI6MjA3NzYwNTIwNX0.OBCL4RWR3A536ZZrAof_tI5QNDYRJeA5x6HXv-P4d6s")},1396:function(e,s,t){e.exports=t(5250)},4033:function(e,s,t){e.exports=t(5313)}},function(e){e.O(0,[673,250,971,938,744],function(){return e(e.s=5011)}),_N_E=e.O()}]);